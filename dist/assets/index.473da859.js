var e=Object.defineProperty,l=(l,t,o)=>(((l,t,o)=>{t in l?e(l,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[t]=o})(l,"symbol"!=typeof t?t+"":t,o),o);import{D as t,d as o,r as a,a as s,o as n,b as i,c as r,e as u,f as p,t as d,g as c,u as m,h as v,w as f,i as b,j as g,F as h,k as y,v as _,l as k,m as x,n as w,p as U,q as V,s as C,x as q}from"./vendor.70cb7161.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&l(e)})).observe(document,{childList:!0,subtree:!0})}function l(e){if(e.ep)return;e.ep=!0;const l=function(e){const l={};return e.integrity&&(l.integrity=e.integrity),e.referrerpolicy&&(l.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?l.credentials="include":"anonymous"===e.crossorigin?l.credentials="omit":l.credentials="same-origin",l}(e);fetch(e.href,l)}}();const D=new class extends t{constructor(){super("SheepNoteDB"),l(this,"sheep"),l(this,"groups"),l(this,"talks"),this.version(1).stores({sheep:"\n        ++id,\n        name,\n        gender,\n        age,\n        address,\n        phone_number,\n        email,\n        note,\n        group_id,\n        last_talk_id,\n        next_talk_id\n      ",groups:"++id, name",talks:"++id, sheep_id, date, details"}),this.sheep=this.table("sheep"),this.groups=this.table("groups"),this.talks=this.table("talks")}},O={class:"card"},j={class:"card-body"},A={class:"card-title fw-bold"},S={class:"card-text"},N=c("最後に訪問した時間"),T=p("br",null,null,-1),$={class:"card-text"},M=c("次に訪問する予定の時間"),F=p("br",null,null,-1),L={class:"text-end"},R={class:"btn-group"},P=c("編集"),B=o({props:{sheep:{type:null,required:!0}},emits:["remove-sheep"],setup(e){const l=e,t=a({}),o=s("--"),b=a({}),g=s("--");function h(e){return["日","月","火","水","木","金","土"][new Date(e.year,e.month-1,e.date,e.hours,e.minutes).getDay()]}return n((async()=>{l.sheep.last_talk_id&&(Object.assign(t,await D.talks.get(l.sheep.last_talk_id)),o.value=h(t)),l.sheep.next_talk_id&&(Object.assign(b,await D.talks.get(l.sheep.next_talk_id)),g.value=h(b))})),(a,s)=>{const n=i("router-link");return r(),u("div",O,[p("div",j,[p("h5",A,d(e.sheep.name),1),p("p",S,[N,T,c(" "+d(m(t).year||"--")+"年 "+d(m(t).month||"--")+"月 "+d(m(t).date||"--")+"日 ("+d(o.value)+") "+d(m(t).hours||"--")+"時 "+d(m(t).minutes||"--")+"分 ",1)]),p("p",$,[M,F,c(" "+d(m(b).year||"--")+"年 "+d(m(b).month||"--")+"月 "+d(m(b).date||"--")+"日 ("+d(g.value)+") "+d(m(b).hours||"--")+"時 "+d(m(b).minutes||"--")+"分 ",1)]),p("div",L,[p("div",R,[v(n,{to:{name:"edit",params:{sheep_id:e.sheep.id}},class:"btn"},{default:f((()=>[P])),_:1},8,["to"]),p("button",{type:"button",class:"btn",onClick:s[0]||(s[0]=e=>a.$emit("remove-sheep",l.sheep))},"削除")])])])])}}}),E=o({setup(e){const l=s([]);function t(e){confirm(`${e.name} さんの情報を削除しますか？`)&&(l.value.splice(l.value.indexOf(e),1),e.id&&D.sheep.delete(e.id))}return n((async()=>{l.value=await D.sheep.toArray()})),(e,o)=>(r(!0),u(h,null,b(l.value,(e=>(r(),g(B,{key:e.id,sheep:e,onRemoveSheep:t},null,8,["sheep"])))),128))}}),H={class:"form-group"},I=p("label",{class:"form-label"},"名前",-1),K={class:"form-group"},Y=p("label",{class:"form-label"},"性別",-1),z=[p("option",{value:"Male"},"男性",-1),p("option",{value:"Female"},"女性",-1)],G={class:"form-group"},J=p("label",{class:"form-label"},"年齢",-1),Q=[x('<option value="0">0~9</option><option value="10">10~19</option><option value="20">20~29</option><option value="30">30~39</option><option value="40">40~49</option><option value="50">50~59</option><option value="60">60~69</option><option value="70">70~79</option><option value="80">80~89</option><option value="90">90~99</option><option value="100">100~</option>',11)],W={class:"form-group"},X=p("label",{class:"form-label"},"住所",-1),Z={class:"form-group"},ee=p("label",{class:"form-label"},"電話番号",-1),le={class:"form-group"},te=p("label",{class:"form-label"},"メール",-1),oe={class:"form-group"},ae=p("label",{class:"form-label"},"グループ",-1),se=p("option",null,"未選択",-1),ne=["value"],ie={class:"form-group"},re=p("label",{class:"form-label"},"どんな人?",-1),ue=c("登録"),pe=o({setup(e){const l=a({}),t=s([]);function o(){l.name&&D.sheep.add(l)}return n((async()=>{t.value=await D.groups.toArray()})),(e,a)=>{const s=i("router-link");return r(),u(h,null,[p("div",H,[I,y(p("input",{type:"text",class:"form-control","onUpdate:modelValue":a[0]||(a[0]=e=>m(l).name=e)},null,512),[[_,m(l).name]])]),p("div",K,[Y,y(p("select",{class:"form-select","onUpdate:modelValue":a[1]||(a[1]=e=>m(l).gender=e)},z,512),[[k,m(l).gender]])]),p("div",G,[J,y(p("select",{class:"form-select","onUpdate:modelValue":a[2]||(a[2]=e=>m(l).age=e)},Q,512),[[k,m(l).age]])]),p("div",W,[X,y(p("textarea",{class:"form-control","onUpdate:modelValue":a[3]||(a[3]=e=>m(l).address=e)},null,512),[[_,m(l).address]])]),p("div",Z,[ee,y(p("input",{type:"tel",class:"form-control","onUpdate:modelValue":a[4]||(a[4]=e=>m(l).phone_number=e)},null,512),[[_,m(l).phone_number]])]),p("div",le,[te,y(p("input",{type:"email",class:"form-control","onUpdate:modelValue":a[5]||(a[5]=e=>m(l).email=e)},null,512),[[_,m(l).email]])]),p("div",oe,[ae,y(p("select",{class:"form-select","onUpdate:modelValue":a[6]||(a[6]=e=>m(l).group_id=e)},[se,(r(!0),u(h,null,b(t.value,(e=>(r(),u("option",{value:e.id},d(e.name),9,ne)))),256))],512),[[k,m(l).group_id,void 0,{number:!0}]])]),p("div",ie,[re,y(p("textarea",{class:"form-control","onUpdate:modelValue":a[7]||(a[7]=e=>m(l).note=e)},null,512),[[_,m(l).note]])]),v(s,{to:"/",class:"btn w-100",onClick:o},{default:f((()=>[ue])),_:1})],64)}}}),de={class:"talk-editor border-top mt-2 pt-2",style:{"border-top-color":"rgba(138, 84, 68, 0.5) !important"}},ce={class:"form-group"},me={class:"form-label d-flex"},ve=p("label",{class:"me-auto",style:{"line-height":"40px"}},"日付",-1),fe={class:"btn-group"},be={class:"row gy-2"},ge={class:"col-sm-6"},he={class:"row"},ye={class:"input-group col"},_e=p("span",{class:"input-group-text"},"年",-1),ke={class:"input-group col"},xe=p("span",{class:"input-group-text"},"月",-1),we={class:"col-sm-6"},Ue={class:"row"},Ve={class:"input-group col"},Ce=p("span",{class:"input-group-text"},"日",-1),qe={class:"input-group col"},De=["value"],Oe=[x('<option value="0">日</option><option value="1">月</option><option value="2">火</option><option value="3">水</option><option value="4">木</option><option value="5">金</option><option value="6">土</option>',7)],je=p("span",{class:"input-group-text"},"曜日",-1),Ae={class:"form-group"},Se=p("label",{class:"form-label"},"時間",-1),Ne={class:"row"},Te={class:"input-group col"},$e=p("span",{class:"input-group-text"},"時",-1),Me={class:"input-group col"},Fe=p("span",{class:"input-group-text"},"分",-1),Le={class:"form-group"},Re=p("label",{class:"form-label"},"話した内容",-1),Pe=o({props:{talk:{type:null,required:!0}},emits:["talk-save","talk-remove"],setup(e){const l=a(e.talk),t=w((()=>new Date(l.year,l.month-1,l.date).getDay()));return(e,o)=>(r(),u("div",de,[p("div",ce,[p("div",me,[ve,p("div",fe,[p("button",{type:"button",class:"btn",onClick:o[0]||(o[0]=t=>e.$emit("talk-save",m(l)))},"保存"),p("button",{type:"button",class:"btn",onClick:o[1]||(o[1]=t=>e.$emit("talk-remove",m(l)))},"削除")])]),p("div",be,[p("div",ge,[p("div",he,[p("div",ye,[y(p("input",{type:"number",class:"form-control","onUpdate:modelValue":o[2]||(o[2]=e=>m(l).year=e)},null,512),[[_,m(l).year,void 0,{number:!0}]]),_e]),p("div",ke,[y(p("input",{type:"number",class:"form-control","onUpdate:modelValue":o[3]||(o[3]=e=>m(l).month=e)},null,512),[[_,m(l).month,void 0,{number:!0}]]),xe])])]),p("div",we,[p("div",Ue,[p("div",Ve,[y(p("input",{type:"number",class:"form-control","onUpdate:modelValue":o[4]||(o[4]=e=>m(l).date=e)},null,512),[[_,m(l).date,void 0,{number:!0}]]),Ce]),p("div",qe,[p("select",{class:"form-select",disabled:"",value:m(t)},Oe,8,De),je])])])])]),p("div",Ae,[Se,p("div",Ne,[p("div",Te,[y(p("input",{type:"number",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=e=>m(l).hours=e)},null,512),[[_,m(l).hours,void 0,{number:!0}]]),$e]),p("div",Me,[y(p("input",{type:"number",class:"form-control","onUpdate:modelValue":o[6]||(o[6]=e=>m(l).minutes=e)},null,512),[[_,m(l).minutes,void 0,{number:!0}]]),Fe])])]),p("div",Le,[Re,y(p("textarea",{class:"form-control","onUpdate:modelValue":o[7]||(o[7]=e=>m(l).details=e)},null,512),[[_,m(l).details]])])]))}}),Be={class:"form-group"},Ee=p("label",{class:"me-auto",style:{"line-height":"40px"}},"名前",-1),He={class:"form-group"},Ie=p("label",{class:"form-label"},"性別",-1),Ke=[p("option",{value:"Male"},"男性",-1),p("option",{value:"Female"},"女性",-1)],Ye={class:"form-group"},ze=p("label",{class:"form-label"},"年齢",-1),Ge=[x('<option value="0">0~9</option><option value="10">10~19</option><option value="20">20~29</option><option value="30">30~39</option><option value="40">40~49</option><option value="50">50~59</option><option value="60">60~69</option><option value="70">70~79</option><option value="80">80~89</option><option value="90">90~99</option><option value="100">100~</option>',11)],Je={class:"form-group"},Qe=p("label",{class:"form-label"},"住所",-1),We={class:"form-group"},Xe=p("label",{class:"form-label"},"電話番号",-1),Ze={class:"form-group"},el=p("label",{class:"form-label"},"メール",-1),ll={class:"form-group"},tl=p("label",{class:"form-label"},"グループ",-1),ol=p("option",null,"未選択",-1),al=["value"],sl={class:"form-group"},nl=p("label",{class:"form-label"},"どんな人?",-1),il=p("label",{class:"me-auto",style:{"line-height":"40px"}},"訪問履歴",-1),rl=o({props:{sheep_id:{type:String,required:!0}},setup(e){const l=e,t=a({}),o=s([]),i=s([]);function c(){t.id&&t.name&&D.sheep.update(t.id,t)}function v(e){return new Date(e.year,e.month-1,e.date,e.hours,e.minutes)}function f(){if(!t.id)return;const e=new Date;i.value.push({sheep_id:t.id,year:e.getFullYear(),month:e.getMonth()+1,date:e.getDate(),hours:e.getHours(),minutes:e.getMinutes(),details:""})}async function x(e){if(t.id){if(e.sheep_id=t.id,await D.talks.put(e).then((l=>e.id=l)),t.last_talk_id){if(t.last_talk_id===e.id){const e=i.value.reduce(((e,l)=>v(e).getTime()>v(l).getTime()?e:l));if(t.last_talk_id===e.id)return;return t.last_talk_id=e.id,void D.sheep.update(t.id,{last_talk_id:e.id})}const l=await D.talks.get(t.last_talk_id);if(l&&v(l)>v(e))return}t.last_talk_id=e.id,D.sheep.update(t.id,{last_talk_id:e.id})}}function w(e){if(t.id&&confirm("訪問履歴を削除しますか？")&&(i.value.splice(i.value.indexOf(e),1),e.id&&(D.talks.delete(e.id),t.last_talk_id===e.id))){if(0===i.value.length)return t.last_talk_id=void 0,void D.sheep.update(t.id,{last_talk_id:void 0});const e=i.value.reduce(((e,l)=>v(e).getTime()>v(l).getTime()?e:l));t.last_talk_id=e.id,D.sheep.update(t.id,{last_talk_id:e.id})}}return n((async()=>{const e=Number(l.sheep_id);Object.assign(t,await D.sheep.get(e)),o.value=await D.groups.toArray(),i.value=await D.talks.where("sheep_id").equals(e).toArray()})),(e,l)=>(r(),u(h,null,[p("div",Be,[p("div",{class:"form-label d-flex"},[Ee,p("button",{type:"button",class:"btn",onClick:c},"保存")]),y(p("input",{type:"text",class:"form-control","onUpdate:modelValue":l[0]||(l[0]=e=>m(t).name=e)},null,512),[[_,m(t).name]])]),p("div",He,[Ie,y(p("select",{class:"form-select","onUpdate:modelValue":l[1]||(l[1]=e=>m(t).gender=e)},Ke,512),[[k,m(t).gender]])]),p("div",Ye,[ze,y(p("select",{class:"form-select","onUpdate:modelValue":l[2]||(l[2]=e=>m(t).age=e)},Ge,512),[[k,m(t).age,void 0,{number:!0}]])]),p("div",Je,[Qe,y(p("textarea",{class:"form-control","onUpdate:modelValue":l[3]||(l[3]=e=>m(t).address=e)},null,512),[[_,m(t).address]])]),p("div",We,[Xe,y(p("input",{type:"tel",class:"form-control","onUpdate:modelValue":l[4]||(l[4]=e=>m(t).phone_number=e)},null,512),[[_,m(t).phone_number]])]),p("div",Ze,[el,y(p("input",{type:"email",class:"form-control","onUpdate:modelValue":l[5]||(l[5]=e=>m(t).email=e)},null,512),[[_,m(t).email]])]),p("div",ll,[tl,y(p("select",{class:"form-select","onUpdate:modelValue":l[6]||(l[6]=e=>m(t).group_id=e)},[ol,(r(!0),u(h,null,b(o.value,(e=>(r(),u("option",{value:e.id},d(e.name),9,al)))),256))],512),[[k,m(t).group_id,void 0,{number:!0}]])]),p("div",sl,[nl,y(p("textarea",{class:"form-control","onUpdate:modelValue":l[7]||(l[7]=e=>m(t).note=e)},null,512),[[_,m(t).note]])]),p("div",{class:"form-label d-flex"},[il,p("button",{type:"button",class:"btn",onClick:f},"追加")]),(r(!0),u(h,null,b(i.value,(e=>(r(),g(Pe,{talk:e,onTalkSave:x,onTalkRemove:w},null,8,["talk"])))),256))],64))}}),ul={class:"card"},pl={class:"card-body"},dl=["onUpdate:modelValue"],cl={class:"btn-group w-100"},ml=c("メンバーを表示"),vl=["onClick"],fl=["onClick"],bl=o({setup(e){const l=s([]);function t(){l.value.push({})}return n((async()=>{l.value=await D.groups.toArray()})),(e,o)=>{const a=i("router-link");return r(),u(h,null,[p("button",{type:"button",class:"btn w-100 mb-2",onClick:t},"新規作成"),(r(!0),u(h,null,b(l.value,(e=>(r(),u("div",ul,[p("div",pl,[y(p("input",{type:"text",class:"form-control mb-2","onUpdate:modelValue":l=>e.name=l},null,8,dl),[[_,e.name]]),p("div",cl,[e.id?(r(),g(a,{key:0,to:{name:"group",params:{group_id:e.id}},class:"btn"},{default:f((()=>[ml])),_:2},1032,["to"])):U("",!0),p("button",{type:"button",class:"btn",onClick:t=>{var o;(o=e).name&&1===l.value.reduce(((e,l)=>e+(l.name===o.name?1:0)),0)&&D.groups.put(o).then((e=>o.id=e))}},"保存",8,vl),p("button",{type:"button",class:"btn",onClick:t=>function(e){confirm(`グループ：${e.name} を削除しますか？`)&&(l.value.splice(l.value.indexOf(e),1),e.id&&(D.groups.delete(e.id),D.sheep.where("group_id").equals(e.id).modify({group_id:null})))}(e)},"削除",8,fl)])])])))),256))],64)}}}),gl={class:"fw-bold"},hl=o({props:{group_id:{type:String,required:!0}},setup(e){const l=Number(e.group_id),t=s(""),o=s([]);function a(e){confirm(`${e.name} さんの情報をグループから削除しますか？`)&&(o.value.splice(o.value.indexOf(e),1),e.id&&D.sheep.update(e.id,{group_id:void 0}))}return n((async()=>{D.groups.get(l).then((e=>{e&&(t.value=e.name)})),o.value=await D.sheep.where("group_id").equals(l).toArray()})),(e,l)=>(r(),u(h,null,[p("h4",gl,d(t.value),1),(r(!0),u(h,null,b(o.value,(e=>(r(),g(B,{key:e.id,sheep:e,onRemoveSheep:a},null,8,["sheep"])))),128))],64))}}),yl=V({history:C(),routes:[{path:"/",name:"index",component:E},{path:"/register",name:"register",component:pe},{path:"/:sheep_id",name:"edit",component:rl,props:!0},{path:"/groups",name:"groups",component:bl},{path:"/group/:group_id",name:"group",component:hl,props:!0}]});const _l={class:"nav"},kl=p("img",{src:"/hitsuji.png",height:"60"},null,-1),xl=c("登録"),wl=c("グループ一覧"),Ul={class:"container"};q(o({setup(e){function l(){confirm("データを全て消去しますか？")&&confirm("本当にいいですか？")&&(D.sheep.clear(),D.groups.clear(),D.talks.clear())}return(e,t)=>{const o=i("router-link"),a=i("router-view");return r(),u(h,null,[p("nav",_l,[v(o,{to:"/",class:"nav-link ps-2"},{default:f((()=>[kl])),_:1}),v(o,{to:"/register",class:"nav-link"},{default:f((()=>[xl])),_:1}),v(o,{to:"/groups",class:"nav-link"},{default:f((()=>[wl])),_:1}),p("span",{class:"nav-link",onClick:l},"リセット")]),p("div",Ul,[v(a)])],64)}}})).use(yl).mount("#app");
